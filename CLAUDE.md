# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a Splunk Add-on for MaxMind GeoIP lookups, built using the Splunk UCC (Universal Configuration Console) framework. It provides a custom streaming search command (`maxmind`) that performs country lookups using MaxMind databases.

## Commands

```bash
# Setup environment
mise install    # Install Python 3.13
uv sync         # Install build dependencies

# Build the add-on
./build.sh      # Generates output/ directory and .tar.gz package

# Run tests
python test_maxmind_command.py

# Install to Splunk (requires Splunk 10.2)
splunk install app /path/to/demo_addon_for_splunk-1.0.0.tar.gz
splunk install app /path/to/demo_addon_for_splunk-1.0.0.tar.gz -update true  # Update existing
```

## Project Structure

```
demo_addon_for_splunk/
├── globalConfig.json      # Main configuration file for UCC framework
├── package/
│   ├── app.manifest       # Add-on metadata (author, version, description)
│   ├── default/
│   │   └── app.conf       # Splunk app configuration (merged with generated)
│   ├── bin/               # Python scripts (inputs, custom commands)
│   ├── lib/
│   │   └── requirements.txt  # Python dependencies for the add-on
│   ├── static/            # Icons and images
│   └── data/              # Data files (e.g., MaxMind databases)
```

## Key Configuration Files

### globalConfig.json

The main UCC configuration file. Defines:
- Input types and their parameters
- Configuration tabs (accounts, logging)
- Custom search commands
- UI settings

### package/app.manifest

JSON file with add-on metadata:
```json
{
  "info": {
    "author": [{"name": "...", "email": "...", "company": "..."}],
    "title": "...",
    "description": "..."
  }
}
```

### package/default/app.conf

Custom settings merged into the generated `app.conf`. Example:
```ini
[launcher]
author = William Storey
python.version = python3.13
```

## Dependencies

- **Build dependencies**: in `pyproject.toml` (managed by uv)
- **Add-on runtime dependencies**: in `package/lib/requirements.txt` (installed into add-on's lib/)

## UCC Framework Behavior

- UCC generates `.conf` files in the output `default/` directory
- If you provide a file in `package/default/`, UCC merges it (except it won't override user-provided values)
- UCC automatically sets `python.version = python3` in `inputs.conf` for all inputs
- Warning about "not auto generated by UCC framework" for custom settings is expected

## Key Constraints

- The `author` field in `package/default/app.conf` must exactly match the first author name in `package/app.manifest`
- Valid `python.version` values: `python3`, `python3.7`, `python3.9`, `python3.13`
